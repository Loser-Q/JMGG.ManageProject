@*@{
    ViewBag.Title = "基本信息";
    Layout = "~/Views/Shared/_Layout.cshtml";
    }*@




@*@{
    ViewBag.Title = "基本信息";
    }*@
<!DOCTYPE html>

<html>

<head>
    <meta name="viewport" content="width=device-width" />
    <title>广告计划列表</title>
</head>

<body>
    <div class="layui-fluid" style="margin-top: 30px;">
        <div class="layui-card">
            <div class="layui-form ">
                <div class="layui-form-item">
                    <div class="layui-inline">
                        <label class="layui-form-label" style="width: 100px;">广告计划名称</label>
                        <div class="layui-input-inline" style="width: 300px; margin-right: 57px;">
                            <input type="text" name="ADName" class="layui-input" value="">
                        </div>
                    </div>
                    <div class="layui-inline">
                        <label class="layui-form-label" style="width: 100px;">商家计划ID</label>
                        <div class="layui-input-inline">
                            <input type="text" name="BusinessPlanID" class="layui-input" value="">
                        </div>
                    </div>
                </div>
                <div class="layui-form-item">
                    <div class="layui-inline">
                        <label class="layui-form-label" style="width: 100px;">投放时间</label>
                        <div id="put_start_time_box" class="layui-input-inline" style="width: 150px;">
                            <input type="text" class="layui-input datetime" id="startLaunchTime" name="startLaunchTime"
                                placeholder="投放开始时间" readonly value="">
                        </div>
                        <div style="display: inline-block; float: left; margin-right: 10px;">
                            ~
                        </div>
                        <div id="put_end_time_box" class="layui-input-inline" style="width: 150px; margin-right: 30px;">
                            <input type="text" class="layui-input datetime" id="endLaunchTime" name="endLaunchTime"
                                placeholder="投放结束时间" readonly value="">
                        </div>
                    </div>
                    <div class="layui-inline">
                        <label class="layui-form-label" style="width: 100px;">广告计划状态</label>
                        <div class="layui-input-inline">
                            <select name="Status" id="Status">
                                <option value="">全部状态</option>
                                <option value="1">待投放</option>
                                <option value="2">投放中</option>
                                <option value="3">已结束</option>
                                <option value="4">等待审核中</option>
                                <option value="5">未通过审核</option>
                                <option value="6">待提交审核</option>
                                <option value="7">已暂停</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div style="padding-bottom: 10px;">
                    <button class="layui-btn layuiadmin-btn-useradmin" lay-submit lay-filter="LAY-user-front-search">
                        <i class="layui-icon layui-icon-search layuiadmin-button-btn"></i>
                        <lable i18n="footer.search">搜索</lable>
                    </button>
                    <button class="layui-btn layuiadmin-btn-useradmin" lay-submit lay-filter="LAY-user-front-add">
                        <lable i18n="footer.search">新建广告计划</lable>
                    </button>
                </div>
            </div>

            <div class="layui-card-body">
                <table id="LAY-CreativePlan" lay-filter="LAY-CreativePlan"></table>
                <script type="text/html" id="barDemo">
                    <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</a>
                    <a class="layui-btn layui-btn-xs" lay-event="edit">查看报表</a>
                    <a class="layui-btn layui-btn-xs" lay-event="edit">查看报表</a>
                    <a class="layui-btn layui-btn-xs" lay-event="edit">操作记录</a>
                </script>

                <script type="text/html" id="statusTemp">
                {{#  if(d.Switch==1){ }}
                <input type="checkbox" name="Switch" lay-skin="switch" checked   lay-text="开启|关闭"  value= {{ d.Switch}}  lay-filter="status" >
                {{#  } else { }}
                <input type="checkbox" name="Switch" lay-skin="switch"  lay-text="开启|关闭"  value= {{ d.Switch} lay-filter="status" >
                {{#  } }}
                </script>
            </div>
        </div>
    </div>
</body>

</html>
<script>
    layui.use(['form', 'jquery', 'table', 'layer', 'laydate'], function () {
        var $ = layui.jquery;
        var form = layui.form;
        var table = layui.table;
        var layer = layui.layer;
        var laydate = layui.laydate;
        //新增日期插件
        function dateAdd() {
            lay('.datetime').each(function () {
                laydate.render({
                    elem: this,
                    trigger: 'click',
                    type: 'datetime'
                })
            })
        }
        dateAdd();
        table.set({
            parseData: function (res) {
                return {
                    code: res.status, //解析接口状态
                    msg: res.msg, //解析提示文本
                    count: res.data.total ? res.data.total.total : 0, //解析数据长度
                    data: res.data, //解析数据列表
                }
            },
        })
        //表格加载
        var cols = [[
            { field: 'Switch', title: '开关', templet: '#statusTemp' }
            , { field: 'ADPlanID', title: '广告计划ID', }
            , { field: 'BusinessPlanID', title: '商家计划ID', }
            , { field: 'ADName', title: '名称', }
            , { field: 'DeliveryPoint', title: '投放点位', }
            , { field: 'BillingMethod', title: '计费方式', }
            , { field: 'UnitPrice', title: '单价', }
            , { field: 'DayBudget', title: '单日预算', }
            , { field: 'CTRPV', title: 'CTR', }
            , { field: 'CRUUV', title: 'ECPM(CPC)', }
            , { field: 'LaunchSchedule', title: '投放排期', }
            , { field: 'LaunchTime', title: '投放时段', }
            , { field: 'Status', title: '状态', templet: function (d) { if (d.Status == 1) { return '待投放' } if (d.Status == 2) { return '投放中' } if (d.Status == 3) { return '已结束' } if (d.Status == 4) { return '等待审核中' } if (d.Status == 5) { return '未通过审核' } if (d.Status == 6) { return '待提交审核' } if (d.Status == 7) { return '已暂停' } } }
            , { field: 'ApprovalReason', title: '审核原因', }
            , { fixed: 'right', title: '操作', toolbar: '#barDemo', width: 300 }
        ]]
        var tableIns = table.render({
            elem: '#LAY-CreativePlan',
            url: '/CreativePlan/GetList', //数据接口
            cols: cols,
            method: 'post',
            done: function (res) { },
            parseData: function (res) {
                debugger;
                return {
                    code: res.code, //解析接口状态
                    msg: res.msg, //解析提示文本
                    count: res.count ? res.count : 0, //解析数据长度
                    data: res.data, //解析数据列表
                }
            },
            page: true,
            text: {
                none: '暂无相关数据',
            },
            defaultToolbar: [],

        })
        //搜索事件
        form.on('submit(LAY-user-front-search)', function (data) {
            var field = data.field
            //执行重载
            tableIns.reload({
                page: {
                    curr: 1,
                },
                where: field,
            })
        })
        form.on('submit(LAY-user-front-add)', function (data) {
            window.location.href = '../CreativePlan/From';
        })
    });
</script>